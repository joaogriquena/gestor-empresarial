{% extends 'base.html' %}

{% block titulo %}Movimenta√ß√µes{% endblock %}

{% block estilos %}
    <link rel="stylesheet" href="{{ url_for('static', filename='almoxarifado/css/navbar.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='almoxarifado/css/movimentacoes.css') }}">
{% endblock %}

{% block conteudo %}
    {% include 'almoxarifado/_navbar.html' %}

    <div class="container-movimentacoes">
        <h2>Movimenta√ß√µes de Ferramentas</h2>

        <div class="form-section">
            <form method="POST" class="form-movimentacao">
                <div class="campo">
                    <label>Funcion√°rio:</label>
                    <select name="funcionario_id" required>
                        {% for f in funcionarios %}
                            <option value="{{ f.id }}">{{ f.nome }} - {{ f.cargo }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="campo">
                    <label>Ferramenta:</label>
                    <select name="ferramenta_id" required>
                        {% for ferr in ferramentas %}
                            <option value="{{ ferr.id }}">{{ ferr.nome }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="campo">
                    <label>Quantidade:</label>
                    <input type="number" name="quantidade" min="1" required>
                </div>
                <button type="submit" class="btn-registrar">Registrar Sa√≠da</button>
            </form>
        </div>

        <div class="filtro-section">
            <form method="GET" class="form-filtro">
                <input type="text" name="filtro" placeholder="Filtrar por funcion√°rio ou ferramenta" value="{{ filtro or '' }}">
                <button type="submit">üîç Buscar</button>
            </form>
        </div>

        <h3>Hist√≥rico de Movimenta√ß√µes</h3>
        <table class="tabela-movimentacoes">
            <thead>
                <tr>
                    <th>Funcion√°rio</th>
                    <th>Ferramenta</th>
                    <th>Quantidade</th>
                    <th>Tipo</th>
                    <th>Data</th>
                </tr>
            </thead>
            <tbody>
                {% for m in movimentacoes %}
                <tr>
                    <td>{{ m.funcionario.nome }}</td>
                    <td>{{ m.ferramenta.nome }}</td>
                    <td>{{ m.quantidade }}</td>
                    <td>{{ m.tipo }}</td>
                    <td>{{ m.data_hora.strftime('%d/%m/%Y %H:%M') }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}
